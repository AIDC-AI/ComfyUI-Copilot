function getImportPath(filename) {
            return `./${filename}`;
        }
            import{j as e}from"./vendor-markdown-CBmlBP6m.js";import{r as g}from"./vendor-react-Dixhfmvb.js";import{B as k,W as f,a as u,g as b}from"./message-components-BXwDTwU6.js";const D=({checkpointId:l,onRestore:x})=>{const[i,c]=g.useState(!1),o=async()=>{if(!i){c(!0);try{const r=await f.restoreWorkflowCheckpoint(l),d=r.workflow_data_ui||r.workflow_data;d&&(r.workflow_data_ui?u.loadGraphData(d):u.loadApiJson(d),console.log(`Restored workflow checkpoint ${l}`),x())}catch(r){console.error("Failed to restore checkpoint:",r),alert("Failed to restore workflow checkpoint. Please try again.")}finally{c(!1)}}};return e.jsx("button",{onClick:o,disabled:i,className:`p-1 rounded transition-colors ${i?"text-gray-400 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-50"}`,title:`Restore checkpoint ${l}`,children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",className:i?"animate-spin":"",children:[e.jsx("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"}),e.jsx("path",{d:"M8 4.466V2.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 6.658A.25.25 0 0 1 8 6.466z"})]})})};function R({content:l,name:x="Assistant",avatar:i,onAddMessage:c}){const[o,r]=g.useState(!1),[d,h]=g.useState(""),[y,p]=g.useState(!1),[m,j]=g.useState(null);let w;try{w=JSON.parse(l)}catch(t){return console.error("Failed to parse message content:",t),null}const v=async()=>{if(!o){r(!0),p(!0),h(`🔍 Starting workflow analysis...
`);try{await N(),await S()}finally{r(!1)}}},N=async()=>{try{const t=await u.graphToPrompt(),s=localStorage.getItem("sessionId")||"";if(s&&t){const a=await f.saveWorkflowCheckpoint(s,t.output,t.workflow,"debug_start");j(a.version_id),console.log(`Saved debug start checkpoint: ${a.version_id}`)}}catch(t){console.error("Failed to save checkpoint before debug:",t)}},S=async()=>{try{const t=await u.graphToPrompt();let s="",a=null;for await(const n of f.streamDebugAgent(t))n.text&&(s=n.text,h(s),n.ext&&(a=n.ext));if(p(!1),s){const n={id:b(),role:"ai",content:JSON.stringify({text:s,ext:a||[]}),format:"markdown",name:"Assistant"};c?.(n)}}catch(t){console.error("Error calling debug agent:",t),p(!1);const s=t,a={id:b(),role:"ai",content:JSON.stringify({text:`I encountered an error while analyzing your workflow: ${s.message||"Unknown error"}`,ext:[]}),format:"markdown",name:"Assistant"};c?.(a)}};return e.jsxs("div",{className:"w-full space-y-4",children:[e.jsx(k,{name:x,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("p",{className:"text-gray-700 text-sm flex-1",children:w.text}),m&&e.jsx("div",{className:"ml-2 flex-shrink-0",children:e.jsx(D,{checkpointId:m,onRestore:()=>{console.log("Workflow restored from checkpoint")}})})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:v,disabled:o,className:`px-4 py-2 text-white text-sm rounded-md transition-colors ${o?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"}`,children:o?"Analyzing...":"Debug Errors"})})]})}),y&&e.jsx(k,{name:"Assistant",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("pre",{className:"whitespace-pre-wrap text-gray-700 text-sm leading-relaxed",children:d})}),o&&e.jsxs("div",{className:"flex items-center gap-2 text-blue-500 text-sm",children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"}),"Analyzing workflow..."]})]})})]})}export{R as DebugGuide};
